{"version":3,"sources":["../../../../../nodes/Airtop/actions/file/getMany.operation.ts"],"sourcesContent":["import {\n\ttype IExecuteFunctions,\n\ttype INodeExecutionData,\n\ttype INodeProperties,\n} from 'n8n-workflow';\n\nimport { requestAllFiles } from './helpers';\nimport { wrapData } from '../../../../utils/utilities';\nimport { apiRequest } from '../../transport';\nimport type { IAirtopResponse } from '../../transport/types';\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['file'],\n\t\toperation: ['getMany'],\n\t},\n};\n\nexport const description: INodeProperties[] = [\n\t{\n\t\tdisplayName: 'Return All',\n\t\tname: 'returnAll',\n\t\ttype: 'boolean',\n\t\tdefault: false,\n\t\tdescription: 'Whether to return all results or only up to a given limit',\n\t\tdisplayOptions,\n\t},\n\t{\n\t\tdisplayName: 'Limit',\n\t\tname: 'limit',\n\t\ttype: 'number',\n\t\tdisplayOptions: {\n\t\t\tshow: {\n\t\t\t\tresource: ['file'],\n\t\t\t\toperation: ['getMany'],\n\t\t\t\treturnAll: [false],\n\t\t\t},\n\t\t},\n\t\ttypeOptions: {\n\t\t\tminValue: 1,\n\t\t\tmaxValue: 100,\n\t\t},\n\t\tdefault: 10,\n\t\tdescription: 'Max number of results to return',\n\t},\n\t{\n\t\tdisplayName: 'Session IDs',\n\t\tname: 'sessionIds',\n\t\ttype: 'string',\n\t\tdefault: '',\n\t\tdescription:\n\t\t\t'Comma-separated list of <a href=\"https://docs.airtop.ai/api-reference/airtop-api/sessions/create\" target=\"_blank\">Session IDs</a> to filter files by. When empty, all files from all sessions will be returned.',\n\t\tplaceholder: 'e.g. 6aac6f73-bd89-4a76-ab32-5a6c422e8b0b, a13c6f73-bd89-4a76-ab32-5a6c422e8224',\n\t\tdisplayOptions,\n\t},\n\t{\n\t\tdisplayName: 'Output Files in Single Item',\n\t\tname: 'outputSingleItem',\n\t\ttype: 'boolean',\n\t\tdefault: true,\n\t\tdescription:\n\t\t\t'Whether to output one item containing all files or output each file as a separate item',\n\t\tdisplayOptions,\n\t},\n];\n\nexport async function execute(\n\tthis: IExecuteFunctions,\n\tindex: number,\n): Promise<INodeExecutionData[]> {\n\tconst returnAll = this.getNodeParameter('returnAll', index, false) as boolean;\n\tconst limit = this.getNodeParameter('limit', index, 10);\n\tconst sessionIds = this.getNodeParameter('sessionIds', index, '') as string;\n\tconst outputSingleItem = this.getNodeParameter('outputSingleItem', index, true) as boolean;\n\n\tconst endpoint = '/files';\n\tlet files: IAirtopResponse[] = [];\n\n\tconst responseData = returnAll\n\t\t? await requestAllFiles.call(this, sessionIds)\n\t\t: await apiRequest.call(this, 'GET', endpoint, {}, { sessionIds, limit });\n\n\tif (responseData.data?.files && Array.isArray(responseData.data?.files)) {\n\t\tfiles = responseData.data.files;\n\t}\n\n\t/**\n\t * Returns the files in one of two formats:\n\t * - A single JSON item containing an array of all files (when outputSingleItem = true)\n\t * - Multiple JSON items, one per file\n\t * Data structure reference: https://docs.n8n.io/courses/level-two/chapter-1/#data-structure-of-n8n\n\t */\n\tif (outputSingleItem) {\n\t\treturn this.helpers.returnJsonArray({ ...responseData });\n\t}\n\treturn wrapData(files);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,qBAAgC;AAChC,uBAAyB;AACzB,uBAA2B;AAG3B,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,MAAM;AAAA,IACjB,WAAW,CAAC,SAAS;AAAA,EACtB;AACD;AAEO,MAAM,cAAiC;AAAA,EAC7C;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,IACT,aAAa;AAAA,IACb;AAAA,EACD;AAAA,EACA;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,gBAAgB;AAAA,MACf,MAAM;AAAA,QACL,UAAU,CAAC,MAAM;AAAA,QACjB,WAAW,CAAC,SAAS;AAAA,QACrB,WAAW,CAAC,KAAK;AAAA,MAClB;AAAA,IACD;AAAA,IACA,aAAa;AAAA,MACZ,UAAU;AAAA,MACV,UAAU;AAAA,IACX;AAAA,IACA,SAAS;AAAA,IACT,aAAa;AAAA,EACd;AAAA,EACA;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,IACT,aACC;AAAA,IACD,aAAa;AAAA,IACb;AAAA,EACD;AAAA,EACA;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,IACT,aACC;AAAA,IACD;AAAA,EACD;AACD;AAEA,eAAsB,QAErB,OACgC;AAChC,QAAM,YAAY,KAAK,iBAAiB,aAAa,OAAO,KAAK;AACjE,QAAM,QAAQ,KAAK,iBAAiB,SAAS,OAAO,EAAE;AACtD,QAAM,aAAa,KAAK,iBAAiB,cAAc,OAAO,EAAE;AAChE,QAAM,mBAAmB,KAAK,iBAAiB,oBAAoB,OAAO,IAAI;AAE9E,QAAM,WAAW;AACjB,MAAI,QAA2B,CAAC;AAEhC,QAAM,eAAe,YAClB,MAAM,+BAAgB,KAAK,MAAM,UAAU,IAC3C,MAAM,4BAAW,KAAK,MAAM,OAAO,UAAU,CAAC,GAAG,EAAE,YAAY,MAAM,CAAC;AAEzE,MAAI,aAAa,MAAM,SAAS,MAAM,QAAQ,aAAa,MAAM,KAAK,GAAG;AACxE,YAAQ,aAAa,KAAK;AAAA,EAC3B;AAQA,MAAI,kBAAkB;AACrB,WAAO,KAAK,QAAQ,gBAAgB,EAAE,GAAG,aAAa,CAAC;AAAA,EACxD;AACA,aAAO,2BAAS,KAAK;AACtB;","names":[]}