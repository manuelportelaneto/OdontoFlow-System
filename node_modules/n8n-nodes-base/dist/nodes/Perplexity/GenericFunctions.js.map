{"version":3,"sources":["../../../nodes/Perplexity/GenericFunctions.ts"],"sourcesContent":["import type {\n\tIExecuteSingleFunctions,\n\tIN8nHttpFullResponse,\n\tINodeExecutionData,\n\tJsonObject,\n} from 'n8n-workflow';\nimport { NodeApiError } from 'n8n-workflow';\n\nexport async function sendErrorPostReceive(\n\tthis: IExecuteSingleFunctions,\n\tdata: INodeExecutionData[],\n\tresponse: IN8nHttpFullResponse,\n): Promise<INodeExecutionData[]> {\n\tif (String(response.statusCode).startsWith('4') || String(response.statusCode).startsWith('5')) {\n\t\tconst errorBody = response.body as JsonObject;\n\t\tconst error = (errorBody?.error ?? {}) as JsonObject;\n\n\t\tconst errorMessage =\n\t\t\ttypeof error.message === 'string'\n\t\t\t\t? error.message\n\t\t\t\t: (response.statusMessage ?? 'An unexpected issue occurred');\n\t\tconst errorType = typeof error.type === 'string' ? error.type : 'UnknownError';\n\t\tconst itemIndex = typeof error.itemIndex === 'number' ? `[Item ${error.itemIndex}]` : '';\n\n\t\tif (errorType === 'invalid_model') {\n\t\t\tthrow new NodeApiError(this.getNode(), errorBody, {\n\t\t\t\tmessage: 'Invalid model',\n\t\t\t\tdescription:\n\t\t\t\t\t'The model is not valid. Permitted models can be found in the documentation at https://docs.perplexity.ai/guides/model-cards.',\n\t\t\t});\n\t\t}\n\n\t\t// Fallback for other errors\n\t\tthrow new NodeApiError(this.getNode(), response as unknown as JsonObject, {\n\t\t\tmessage: `${errorMessage}${itemIndex ? ' ' + itemIndex : ''}.`,\n\t\t\tdescription:\n\t\t\t\t'Any optional system messages must be sent first, followed by alternating user and assistant messages. For more details, refer to the API documentation: https://docs.perplexity.ai/api-reference/chat-completions',\n\t\t});\n\t}\n\treturn data;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,0BAA6B;AAE7B,eAAsB,qBAErB,MACA,UACgC;AAChC,MAAI,OAAO,SAAS,UAAU,EAAE,WAAW,GAAG,KAAK,OAAO,SAAS,UAAU,EAAE,WAAW,GAAG,GAAG;AAC/F,UAAM,YAAY,SAAS;AAC3B,UAAM,QAAS,WAAW,SAAS,CAAC;AAEpC,UAAM,eACL,OAAO,MAAM,YAAY,WACtB,MAAM,UACL,SAAS,iBAAiB;AAC/B,UAAM,YAAY,OAAO,MAAM,SAAS,WAAW,MAAM,OAAO;AAChE,UAAM,YAAY,OAAO,MAAM,cAAc,WAAW,SAAS,MAAM,SAAS,MAAM;AAEtF,QAAI,cAAc,iBAAiB;AAClC,YAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,WAAW;AAAA,QACjD,SAAS;AAAA,QACT,aACC;AAAA,MACF,CAAC;AAAA,IACF;AAGA,UAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,UAAmC;AAAA,MACzE,SAAS,GAAG,YAAY,GAAG,YAAY,MAAM,YAAY,EAAE;AAAA,MAC3D,aACC;AAAA,IACF,CAAC;AAAA,EACF;AACA,SAAO;AACR;","names":[]}